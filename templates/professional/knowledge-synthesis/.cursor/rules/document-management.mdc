---
description: Document Management
alwaysApply: false
---

# Document Management

Rules for ingesting, parsing, classifying, and storing documents within the knowledge base.

## Ingestion Pipeline

All documents pass through these stages in order:

1. **Intake** - Accept the document (PDF, web clip, note, annotation export)
2. **Parsing** - Extract text, metadata, sections, figures, and references
3. **Classification** - Assign type, topics, domain tags, quality score
4. **Enrichment** - Resolve citations, extract keywords, run NER, cross-reference
5. **Storage** - Index full text, store metadata, generate vector embeddings, archive file

## Metadata Requirements

Every ingested document must have:

- Unique ID (UUID, never reuse)
- Title (extracted or manually assigned)
- Author(s)
- Date (published or accessed)
- Document type (paper, book, note, report, article, lecture, email)
- At least one topic tag
- Relevance score (1-5)
- Ingestion date
- Original file hash for deduplication

## Classification Standards

| Type | Priority | Retention Policy |
|------|----------|-----------------|
| Academic Paper | High | Permanent |
| Book Chapter | High | Permanent |
| Personal Note | High | Permanent |
| Technical Report | Medium | Review annually |
| Blog Post / Article | Medium | Review bi-annually |
| Lecture / Talk | Medium | Permanent |
| Email / Thread | Low | Archive after extraction |
| Social Media | Low | Extract insights only |

## Duplicate Detection

Apply these methods in order, stopping at the first match:

1. Exact file hash (SHA-256) for identical files
2. DOI or ISBN match for published works
3. Title + Author fuzzy match (Levenshtein distance < 3)
4. Embedding cosine similarity > 0.95 for semantic duplicates

When a duplicate is found, merge metadata and discard the newer copy. Never silently create duplicates.

## Processing State Tracking

Track processing state for every document:

- `parsed` - Text and metadata extracted
- `summarized` - Progressive summarization level (0-3)
- `linked` - Connected to knowledge graph
- `reviewed` - Last human review date

Documents in the inbox that remain unprocessed for more than 7 days should be flagged for triage.

## File Organization

- Store original files with their hash as filename in an archive directory
- Keep metadata in a structured store (JSON, SQLite, or dedicated DB)
- Generate vector embeddings at the paragraph level for papers, section level for books
- Maintain a full-text search index updated on every ingestion

## Quality Gates

Before a document is considered fully ingested:

- [ ] Metadata complete (no blank required fields)
- [ ] No duplicate detected or duplicate resolved
- [ ] At least one topic tag assigned
- [ ] Full text indexed
- [ ] Vector embedding generated
- [ ] Processing state updated
